<!DOCTYPE HTML>
<html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->


    <title>nanoTwitter Home</title>

    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      body {
        /*padding-top: 60px;*/
        background-color: skyblue;
      }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
      $(document).ready(function(){
        $("#ShowTweets").click(function(){
          var url = "api/v1/users/" + document.getElementById("user_name").innerHTML + "/tweets";
          //$("#TESTSECTION").empty().append("JQuery is working");
          $.post(url, function(result){
            var tweets = JSON.parse(result);
            $("#tweet_feed").html("Your Tweets: <br>");
            for(i = 0; i<tweets.length; i++){
              t = tweets[tweets.length-i-1];
              $("#tweet_feed").append(
                "<div class='panel panel-deault'>\n<div class = 'panel panel-heading'>\n" +
                 t.author_name + " tweeted at " + t.created_at + ":\n</div>" +
                 "<div class='panel panel-body'>\n" + t.text +"\n</div>\n</div>\n<br>");
               };
          //  $("#tweet_feed").html(tweets[1].text);
        });
    });
  });
</script>

  </head>
  <body>


     <%= erb :navbar %>

<!-- Begin page-->
<div class="container">
  <div class="row" background-color>
    <div class="col-md-4">
      <div class="panel panel-default">
        <div class="panel-body">
      <h1> Hey <%= @user[:name] %> </h1>
          <h3> User Info: </h3>
          <ul>
          <li> Username: <div id="user_name"><%= @user[:user_name]%></div></li>
          <li> Email: <%= @user[:email]%> </li>
          <li> Followers: <%= @user[:follower_count]%> </li>
          <li> Follows: <%=@user[:following_count]%> </li>
          <li> Number of tweets:<a id="ShowTweets"> <%=@user[:tweet_count]%> </a></li>
        </ul>
      </div>
      </div>
      </div>
      <div class="col-md-6">
        <form action="/tweet/new/submit" method="POST">
        <div class="form-group">
             <label for="RoarInput">Roar!</label>
             <textarea type=text class="form-control" name= "tweet_text" id="Tweet_input" rows="3"></textarea>
        </div>
          <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <div id = "tweet_feed">
      Tweets by People you Follow:
      <br>
      <% @tweets.each do |tweet| %>
          <div class="panel panel-default">
            <div class="panel panel-heading">
              <%=tweet.author_name%> tweeted at <%=tweet.created_at%> :
            </div>
            <div class ="panel panel-body">
              <%= tweet.text%>
            </div>
          </div>
          <br>
        <%end%>
      </div>
      </div>
    </div>
  </div>
  <script>window.jQuery || document.write('<script src="js/jquery-1.7.1.min.js"><\/script>')</script>

<!--Bootstrap jQuery Plugins, compiled and minified -->
<script src="/js/bootstrap.min.js"></script>


</body>
</html>
